<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <script th:src="@{js/dictation.js}"></script>
    <script th:src="@{jquery-3.3.1.js}"></script>
    <script th:src="@{layer/layer.js}"></script>
    <link rel="stylesheet" href="css/dictation.css" type="text/css" />
    <title>语音录入</title>
</head>
<script>
    //录入单词
    function add() {
        layer.open({
            type: 1,
            skin: 'layui-layer-rim', //加上边框
            area: ['400px', '350px'], //宽高
            content: $("#add")
        });
        len=1;
        $("#j").click(function () {
            $("#samp1").append('<input type="text" id="word"><br>');
            len+=1;
        });
        //多天记录添加
        $("#but").click(function(){
            var $inputArr = $('#add #word');//length = 3
            //循环处理input,并定义结果集
            var result = [];
            $inputArr.each(function(){
                //将每个input的值放进结果集
                result.push($(this).val());
            });
            //5.打印结果
            alert(result);
            arr=result.join(",");
            $.ajax({
                url: "/addWords",
                data:{"word":arr},
                success: function (data) {
                   if (data=true){
                       alert("添加成功")
                   }
                }
            })

        });
    }

    //删除
    function del(id) {
        if(confirm("确定要删除吗?")){
            $.ajax({
                url: "delWords",
                data:{id:id},
                success: function (data) {
                    //alert(data);
                    if (data == "true") {
                        window.location.href = "/";
                    } else {
                        layer.msg("删除失败");
                    }
                }
            })
        }
    }
//修改提交
    function edit(id) {
        $("#samp2").empty();
        layer.open({
            type: 1,
            skin: 'layui-layer-rim', //加上边框
            area: ['400px', '350px'], //宽高
            content: $("#updata")
        });
        $.ajax({
            url: "/allidWords",
            data:{id:id},
            success: function (data) {
                arr=data['word']
                a=arr.split(',');
                 str = "";
                for(var i=0;i<a.length;i++)
                {

                    $(this).val("");
                    $('left #upword').val(a[i]);
                    if (i>0){
                        $("#samp2").append('<input type="text" id="word"><br>');

                    }
                }

            }
        })

        $("#updataword").click(function(){
            var $inputArr = $('#updata #upword');//length = 3
            //循环处理input,并定义结果集
            var result = [];
            $inputArr.each(function(){
                //将每个input的值放进结果集
                result.push($(this).val());
            });
            //5.打印结果
            alert(result);
            arr=result.join(",");
            $.ajax({
                url: "/updateWords",
                data:{"word":arr,"id":id},
                success: function (data) {
                    if (data=true){
                        alert("添加成功")
                    }
                }
            })

        });

    };


    $("#updataword").click(function(){
        $.post(
            "/updateWords",
            {id:id},
            function (data) {
                alert("成功")
            },
            "json"
        );
    });





</script>
<body>
<table class="table" border="1" style="border: #8D8D8D;border-collapse: collapse">
    <legend>
        <strong>语音录入</strong>
    </legend>
    <input type="button" class="button" value="录入单词" onclick="add()">
    <thead>
    <tr>
        <th>ID</th>
        <th>单词</th>
        <th>创建时间</th>
        <th>删除状态</th>
        <th>操作</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="l,userStat : ${list}">
        <td th:text="${l.id}">55</td>
        <td><a th:text="${l.word}" th:id="'t_'+${l.id}"></a></td>
        <td th:text="${l.creationTime}"></td>
        <td th:text="${l.deletedState}==0?'正常':'已删除'" th:id="'del_'+${l.id}"></td>
        <td>
            <input type="button" class="button" value="修改" th:onclick="|edit(${l.id})|" >
            <input type="button"  class="button-red" value="删除" th:onclick="|del(${l.id})|">
            <input type="button" class="button" value="播放" th:onclick="|play(${l.id})|">
        </td>
    </tr>
    </tbody>
</table>

<div id="add" style="display:none;">
    请输入单词：
    <form >
        <input type="text" id="word"><br/><samp id="samp1"></samp>
        <input type="button" class="button" value="+" id="j">
        <input type="button" class="button" value="提交" id="but">
    </form>
</div>
<div id="updata" style="display:none;" >
    <form>
        <input type="text" id="upword" value=""><br/><samp id="samp2"></samp>
        <input type="button" class="button" value="提交" id="updataword">
    </form>

</div>
</body>
</html>
